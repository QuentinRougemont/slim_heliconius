// Keywords: migration, dispersal, fitness()

initialize() {
  	defineGlobal("MU", 1e-7);
   defineGlobal("L", 1e5);  //will be set to 1e7 later
   defineGlobal("R", 1e-8);
	initializeMutationRate(MU);
	initializeMutationType("m1", 0.5, "f", 0.0);
	initializeGenomicElementType("g1", m1, 1.0);
	initializeGenomicElement(g1, 0, L-1);
	initializeRecombinationRate(R);
}
1 {
	//sim.setValue("FST", 0.0);

	subpopCount = 5; 
	for (i in 1:subpopCount)
	sim.addSubpop(i, 500);
	for (i in 2:subpopCount)
	sim.subpopulations[i-1].setMigrationRates(i-1, 0.01);
	for (i in 1:(subpopCount-1))
	sim.subpopulations[i-1].setMigrationRates(i+1, 0.01);


}
18999 late() {
	//cat("Mean FST at equilibrium: " + (sim.getValue("FST") / 10000) + "\n" );
	het = calcHeterozygosity(p1.genomes);
	pi2 = calcHeterozygosity(p2.genomes);
	pi3 = calcHeterozygosity(p3.genomes);
	pi4 = calcHeterozygosity(p4.genomes);
	pi5 = calcHeterozygosity(p5.genomes);

	cat("pi1 :" +  het + "\n" );
	cat("pi2 :" +  pi2 + "\n" );
	cat("pi3 :" +  pi3 + "\n" );
	cat("pi4 :" +  pi4 + "\n" );
	cat("pi5 :" +  pi5 + "\n" );

	sim.simulationFinished();
}
